---
title: 单片机远程升级（一）——烧录程序三种方式
date: 2023-01-16 15:13:43
tags: 单片机
categories: 单片机
---

## 一.烧录程序三种方式

1.ISP：在系统中编程。出厂时ST公司已经在ROM中写入了BootLoader，通过通信接口就可以擦除与编程用户程序。

2.IAP：在应用程序中编程。用户在运行程序的时候，通过BootLoader程序对指定的Flash区域进行烧录。用户可以自己写入一个BootLoader程序来运行存储在Flash中指定区域的程序，在程序的运行过程中我们就可以通过任何通讯方式，把接收到的bin程序写入到指定区域的Flash中，然后进行应用程序的升级。

3.ICP：在电路编程。这是一种串行编程方式，可以使用JTAG或SWD接口来对STM32进行程序烧写。

## 二.BootLoader

BootLoader是一段引导程序，当单片机上电/复位后在用户程序之前先运行。它判断当前是否需要进入升级状态。如果不需要升级，就直接运行Flash中原有的程序；如果需要升级，首先擦除旧的程序，然后从通信媒介中接收用户程序，同时写入Flash中。

#### 工作原理：

单片机在刚上电的最初极短时间内，先进入BootLoader程序，检测有无升级程序命令。如果有，则升级用户程序，升级完成后自动跳入用户程序区；如果没有，则直接跳入用户程序区。如果单片机正常运行用户程序过程中，当收到预先设置的升级跳转指令时，即结束当前任务，自动复位转入BootLoader程序；当BootLoader程序检验到升级程序命令时即可进行升级，升级结束自动转入用户程序区。

